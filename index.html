<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>临时笔记（LocalStorage 第二桌面）</title>

    <!-- 主题系统 -->
    <link rel="stylesheet" href="./css/theme.css" />
    <!-- 基础样式 -->
    <link rel="stylesheet" href="./css/base.css" />
    <!-- 布局组件 -->
    <link rel="stylesheet" href="./css/layout.css" />
    <!-- UI组件 -->
    <link rel="stylesheet" href="./css/components.css" />
  </head>

  <body>
    <div class="app" id="app">
      <header>
        <div class="title">
          <h1>临时笔记（LocalStorage 第二桌面）</h1>
          <div class="sub">
            <span class="pill"
              >自动保存：<span id="autosaveState">就绪</span></span
            >
            <span class="pill">草稿字数：<span id="wc">0</span></span>
            <span class="pill">草稿占用：<span id="draftUsage">0 KB</span></span>
          </div>
        </div>

        <div class="actions">
          <button
            class="primary"
            id="btnArchive"
            title="把当前草稿保存为一个条目（不清空草稿）"
          >
            存档为条目 <span class="kbd">Ctrl</span>+<span class="kbd">S</span>
          </button>
          <button id="btnCopy" title="复制草稿到剪贴板">复制草稿</button>
          <button
            id="btnClearDraft"
            class="danger"
            title="清空草稿（不可恢复）"
          >
            清空草稿 <span class="kbd">Ctrl</span>+<span class="kbd">L</span>
          </button>
          <button id="btnTheme" title="切换明/暗色">主题</button>
        </div>
      </header>

      <div class="main">
        <!-- Draft -->
        <section class="panel">
          <div class="panel-head">
            <div class="label">
              <span>草稿区（自动保存）</span>
              <span class="muted small">打开即用 重开仍在</span>
            </div>
            <div class="right">
              <span class="muted small"
                >快捷键：<span class="kbd">Ctrl</span>+<span class="kbd">S</span>
                存档，<span class="kbd">Ctrl</span>+<span class="kbd">K</span>
                搜索，<span class="kbd">Ctrl</span>+<span class="kbd">L</span>
                清空</span
              >
            </div>
          </div>
          <textarea
            id="draft"
            spellcheck="false"
            placeholder="把这里当作你的“第二桌面”。随手粘贴、临时记录、快速中转…&#10;&#10;提示：需要留档就点“存档为条目”或Ctrl+S。"
          ></textarea>
        </section>

        <!-- Archive -->
        <section class="panel">
          <div class="panel-head" style="gap: 8px; flex-wrap: wrap">
            <div class="label" style="flex: 1; min-width: 200px">
            <!--<span>存档条目</span>
              <span class="muted small">点击条目可加载到草稿区</span>
                -->
              <div class="muted small" style="display:flex; gap:12px; flex-wrap:wrap; margin-top:1px;">
                <span>存档条目：<span id="countItems">0</span></span>
                <span>总占用估算：<span id="usage">0 KB</span></span>
              </div>
            </div>
            <div class="right" style="flex: 1; min-width: 220px">
              <input
                id="search"
                class="search"
                placeholder="搜索条目（Ctrl+K）"
              />
            </div>
            <div class="right">
              <button
                id="btnMore"
                title="打开更多功能"
              >
                更多
              </button>
            </div>
          </div>

          <div class="list" id="list"></div>
        </section>
      </div>
    </div>

    <div class="toast" id="toast"></div>

    <!-- 更多功能面板（仿ChatGPT设置面板） -->
    <div class="modal-overlay" id="moreModalOverlay" style="display: none;"></div>
    <div class="more-modal" id="moreModal" style="display: none;">
      <!-- 顶部Header -->
      <header class="modal-header">
        <div class="header-title">更多功能</div>
        <button class="modal-close-btn" id="moreModalClose" aria-label="关闭">✕</button>
      </header>

      <!-- 主容器：左侧导航 + 右侧内容 -->
      <div class="modal-body">
        <!-- 左侧导航栏 -->
        <div class="modal-sidebar">
          <div class="sidebar-menu">
            <button class="sidebar-item active" id="sidebarRecycle" data-panel="recycle">
              <span class="sidebar-icon">🗑️</span>
              <span class="sidebar-label">回收站</span>
            </button>
            <button class="sidebar-item" id="sidebarImportExport" data-panel="importExport">
              <span class="sidebar-icon">📤</span>
              <span class="sidebar-label">导入/导出</span>
            </button>
            <button class="sidebar-item" id="sidebarSettings" data-panel="settings">
              <span class="sidebar-icon">⚙️</span>
              <span class="sidebar-label">设置</span>
            </button>
          </div>
        </div>

        <!-- 右侧内容区 -->
        <div class="modal-content">
          <!-- 回收站面板 -->
          <div class="modal-panel active" id="recyclePanel">
            <div class="panel-header">
              <h2 class="panel-title">回收站</h2>
              <input type="text" id="recycleSearch" class="search" placeholder="搜索已删除的条目..." style="width: 100%; margin-top: 8px;">
            </div>
            <div class="panel-body">
              <div class="recycle-list" id="recycleList"></div>
              <div class="recycle-actions" id="recycleActions" style="display: none;">
                <button class="btn-danger" id="recycleClearAll">清空所有</button>
              </div>
            </div>
          </div>

          <!-- 导入/导出面板 -->
          <div class="modal-panel" id="importExportPanel">
            <div class="panel-header">
              <h2 class="panel-title">导入/导出</h2>
            </div>
            <div class="panel-body">
              <div class="import-export-grid">
                <button class="import-export-btn" id="exportBtn">
                  <div class="btn-icon">📥</div>
                  <div class="btn-title">导出为 JSON</div>
                  <div class="btn-desc">将所有数据导出为 JSON 文件</div>
                </button>
                <button class="import-export-btn" id="importBtn">
                  <div class="btn-icon">📤</div>
                  <div class="btn-title">从 JSON 导入</div>
                  <div class="btn-desc">从 JSON 文件导入数据</div>
                </button>
              </div>
            </div>
          </div>

          <!-- 设置面板 -->
          <div class="modal-panel" id="settingsPanel">
            <div class="panel-header">
              <h2 class="panel-title">设置</h2>
            </div>
            <div class="panel-body">
              <div class="settings-group">
                <div class="settings-item">
                  <div class="settings-label">
                    <span class="label-name">字体大小</span>
                    <span class="label-desc">调整文本显示大小</span>
                  </div>
                  <div class="font-size-controls">
                    <input type="range" id="fontSizeSlider" min="12" max="20" value="16" class="font-slider">
                    <span id="fontSizeValue" class="font-size-value">16px</span>
                  </div>
                </div>
                <div class="settings-item" style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--border);">
                  <div class="settings-label">
                    <span class="label-name">大模型配置</span>
                    <span class="label-desc">配置 LLM 配合使用</span>
                  </div>
                  <div style="display: flex; flex-direction: column; gap: 12px; margin-top: 8px;">
                    <div>
                      <label style="display: block; font-size: 12px; color: var(--muted); margin-bottom: 4px;">Base URL</label>
                      <input type="text" id="llmBaseUrl" class="settings-input" placeholder="例如: https://api.openai.com/v1" style="width: 100%; padding: 6px 8px; border: 1px solid var(--border); border-radius: 4px; background: var(--input-bg); color: var(--text);">
                    </div>
                    <div>
                      <label style="display: block; font-size: 12px; color: var(--muted); margin-bottom: 4px;">API Key</label>
                      <input type="password" id="llmApiKey" class="settings-input" placeholder="例如: sk-..." style="width: 100%; padding: 6px 8px; border: 1px solid var(--border); border-radius: 4px; background: var(--input-bg); color: var(--text);">
                    </div>
                    <div>
                      <label style="display: block; font-size: 12px; color: var(--muted); margin-bottom: 4px;">Model</label>
                      <input type="text" id="llmModel" class="settings-input" placeholder="例如: gpt-4 或 claude-3-opus" style="width: 100%; padding: 6px 8px; border: 1px solid var(--border); border-radius: 4px; background: var(--input-bg); color: var(--text);">
                    </div>
                  </div>
                </div>
                <div class="settings-item" style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--border);">
                  <div class="settings-label">
                    <span class="label-name">清除所有内容</span>
                    <span class="label-desc">永久删除所有草稿、条目和回收站数据，无法恢复</span>
                  </div>
                  <button id="btnClearAllData" class="danger" style="width: 100%; margin-top: 8px;">清除所有内容</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 应用主入口 -->
    <script type="module" src="./js/main.js"></script>
  </body>
</html>
